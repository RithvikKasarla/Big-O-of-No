generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["fullTextSearch", "fullTextIndex"]
}

datasource db {
  provider = "mysql"
  url      = env("SQL_DATABASE_URL")
}

model User {
  id       Int     @id @default(autoincrement())
  username String  @unique
  files    File[]  @relation("UserFiles")
  classes  Class[] @relation("ClassMembership")
  comments Comment[] @relation("UserComments")
}

model Class {
  id          Int     @id @default(autoincrement())
  name        String  @unique
  description String?
  files       File[]  @relation("ClassFiles")
  members     User[]  @relation("ClassMembership")
}

model File {
  id       Int    @id @default(autoincrement())
  title    String
  s3_url   String @unique
  rating   Int    @default(0)
  authorId Int
  author   User   @relation("UserFiles", fields: [authorId], references: [id])
  classId  Int
  class    Class  @relation("ClassFiles", fields: [classId], references: [id])
  //comments
  comments Comment[] @relation("FileComments")
}

model Comment {
  id      Int    @id @default(autoincrement())
  content String
  author  User @relation("UserComments", fields: [authorId], references: [id])
  authorId Int
  file    File @relation("FileComments", fields: [fileId], references: [id])
  fileId  Int 
}